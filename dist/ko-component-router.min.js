(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory(require("knockout"));else if(typeof define==="function"&&define.amd)define(["knockout"],factory);else if(typeof exports==="object")exports["ko-component-router"]=factory(require("knockout"));else root["ko-component-router"]=factory(root["ko"])})(this,function(__WEBPACK_EXTERNAL_MODULE_1__){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0)}([function(module,exports,__webpack_require__){"use strict";var ko=__webpack_require__(1);var router=__webpack_require__(2);ko.components.register("ko-component-router",{viewModel:router,template:"<div data-bind='if: ctx.component'>\n      <div data-bind='component: {\n        name: ctx.component,\n        params: ctx\n      }'></div>\n    </div>"})},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_1__},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ko=__webpack_require__(1);var Context=__webpack_require__(3);var Route=__webpack_require__(5);var clickEvent="undefined"!==typeof document&&document.ontouchstart?"touchstart":"click";var location="undefined"!==typeof window&&(window.history.location||window.location);var Router=function(){function Router(_ref,bindingCtx){var routes=_ref.routes;var _ref$base=_ref.base;var base=_ref$base===undefined?"":_ref$base;var _ref$hashbang=_ref.hashbang;var hashbang=_ref$hashbang===undefined?false:_ref$hashbang;_classCallCheck(this,Router);var parentRouterCtx=bindingCtx.$parentContext.$router;var dispatch=true;if(parentRouterCtx){base=parentRouterCtx.config.base+(parentRouterCtx.config.hashbang?"/#!":"")+parentRouterCtx.path();dispatch=parentRouterCtx.path()!==parentRouterCtx.canonicalPath();this.isRoot=false}else{this.isRoot=true}this.onpopstate=this.onpopstate.bind(this);this.onclick=this.onclick.bind(this);window.addEventListener("popstate",this.onpopstate,false);document.addEventListener(clickEvent,this.onclick,false);this.config={base:base,hashbang:hashbang};this.ctx=bindingCtx.$router=new Context(this.config);this.routes={};for(var route in routes){this.routes[route]=new Route(route,routes[route])}if(dispatch){var url=this.config.hashbang&&~location.hash.indexOf("#!")?location.hash.substr(2)+location.search:location.pathname+location.search+location.hash;this.dispatch(url,null,false)}}_createClass(Router,[{key:"dispatch",value:function dispatch(path,state,push){if(path.indexOf(this.config.base)===0){path=path.replace(this.config.base,"")}for(var r in this.routes){var route=this.routes[r];if(route.matches(path)){this.ctx.update(route,path,state,this.isRoot&&push);return true}}if(this.isRoot){location.href=this.ctx.canonicalPath()}else{this.ctx.component(null)}return false}},{key:"onpopstate",value:function onpopstate(e){this.dispatch(location.pathname+location.hash,e.state,false)}},{key:"onclick",value:function onclick(e){if(1!==which(e)||e.metaKey||e.ctrlKey||e.shiftKey){return}var el=e.target;while(el&&"A"!==el.nodeName){el=el.parentNode}if(!el||"A"!==el.nodeName){return}if(el.hasAttribute("download")||el.getAttribute("rel")==="external"){return}var link=el.getAttribute("href");if(!this.config.hashbang&&el.pathname===location.pathname&&(el.hash||"#"===link)){return}if(link&&link.indexOf("mailto:")>-1){return}if(el.target){return}if(!sameOrigin(el.href)){return}var path=el.pathname+el.search+(el.hash||"");var orig=path;var base=this.config.base.replace("/#!","");if(path.indexOf(base)===0){path=path.substr(base.length)}if(this.config.hashbang){path=path.replace("#!","")}if(this.config.base&&orig===path){return}e.preventDefault();this.dispatch(path)}},{key:"dispose",value:function dispose(){document.removeEventListener(clickEvent,this.onclick,false);window.removeEventListener("popstate",this.onpopstate,false)}}]);return Router}();module.exports={createViewModel:function createViewModel(routerParams,componentInfo){return new Router(routerParams,ko.contextFor(componentInfo.element))}};function which(e){e=e||window.event;return null===e.which?e.button:e.which}function sameOrigin(href){var origin=location.protocol+"//"+location.hostname;if(location.port)origin+=":"+location.port;return href&&0===href.indexOf(origin)}},function(module,exports,__webpack_require__){"use strict";var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ko=__webpack_require__(1);var utils=__webpack_require__(4);var Context=function(){function Context(config){_classCallCheck(this,Context);this.config=config;this.route=ko.observable("");this.component=ko.observable();this.state=ko.observable({});this.canonicalPath=ko.observable("");this.path=ko.observable("");this.pathname=ko.observable("");this.hash=ko.observable("");this.params={};this.query={};this.subscribeParams()}_createClass(Context,[{key:"update",value:function update(route,url){var state=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];var push=arguments.length<=3||arguments[3]===undefined?true:arguments[3];this.route(route);if("/"===url[0]&&(0!==url.indexOf(this.config.base)||""===this.config.base)){url=this.config.base+(this.config.hashbang?"/#!":"")+url}else if(0===url.indexOf(this.config.base)&&this.config.hashbang){url=this.config.base+"/#!"+url.substr(this.config.base.length)}this.canonicalPath(url);url=url.replace(this.config.base,"");if(this.config.hashbang){url=url.replace("/#!","")}this.state(state);var _route$parse=route.parse(url);var _route$parse2=_slicedToArray(_route$parse,4);var path=_route$parse2[0];var params=_route$parse2[1];var hash=_route$parse2[2];var pathname=_route$parse2[3];this.path(path);this.pathname(pathname);this.hash(hash);utils.merge(this.params,params);route.exec(this,push)}},{key:"subscribeParams",value:function subscribeParams(){var _this=this;this._paramSubs=[];for(var paramName in this.params){var param=this.params[paramName];this._paramSubs.push(param.subscribe(function(){var url=_this.route().compile(ko.toJS(_this.params));_this.update(_this.route(),url,null,false)}))}this._paramSubsUpdaterSub=this.component.subscribe(function(){_this.unsubscribeParams();_this.subscribeParams()})}},{key:"unsubscribeParams",value:function unsubscribeParams(){this._paramSubsUpdaterSub.dispose();var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this._paramSubs[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var sub=_step.value;sub.dispose()}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}}},{key:"dispose",value:function dispose(){this.unsubscribeParams()}}]);return Context}();module.exports=Context},function(module,exports,__webpack_require__){"use strict";var ko=__webpack_require__(1);function decodeURLEncodedURIComponent(val){if(typeof val!=="string"){return val}return decodeURIComponent(val.replace(/\+/g," "))}function merge(dest,src){for(var prop in src){if(typeof dest[prop]==="undefined")dest[prop]=fromJS(src[prop]);else if(ko.isWritableObservable(dest[prop]))dest[prop](src[prop]);else if(src[prop].constructor===Object)merge(dest[prop],src[prop]);else dest[prop]=src[prop]}}function fromJS(obj,parentIsArray){var obs=undefined;if(isPrimitiveOrDate(obj))obs=parentIsArray?obj:ko.observable(obj);else if(obj instanceof Array){obs=[];for(var i=0;i<obj.length;i++){obs[i]=fromJS(obj[i],true)}obs=ko.observableArray(obs)}else if(obj.constructor===Object){obs={};for(var p in obj){obs[p]=fromJS(obj[p])}}return obs}function isPrimitiveOrDate(obj){return obj===null||obj===undefined||obj.constructor===String||obj.constructor===Number||obj.constructor===Boolean||obj instanceof Date}module.exports={decodeURLEncodedURIComponent:decodeURLEncodedURIComponent,merge:merge}},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var pathtoRegexp=__webpack_require__(6);var utils=__webpack_require__(4);var Route=function(){function Route(path,args){var _this=this;_classCallCheck(this,Route);if(path[path.length-1]==="!"){path=path.replace("!",":child_path(.*)?")}else if(path==="*"){path="(.*)"}if(typeof args==="string"){this.callbacks=[this.getComponentSetter(args)]}else{this.callbacks=args.map(function(h){return typeof h==="string"?_this.getComponentSetter(h):h})}this._keys=[];this._regexp=pathtoRegexp(path,this._keys);this._compile=pathtoRegexp.compile(path)}_createClass(Route,[{key:"exec",value:function exec(ctx,push){var callbacks=this.callbacks;var i=0;next();function next(){var fn=callbacks[i++];if(fn){fn(ctx,next)}else{history[push?"pushState":"replaceState"](ctx.state(),document.title,""===ctx.canonicalPath()?ctx.config.base:ctx.canonicalPath())}}}},{key:"matches",value:function matches(path){return this._regexp.exec(decodeURIComponent(path))}},{key:"getComponentSetter",value:function getComponentSetter(c){return function(ctx,next){ctx.component(c);next()}}},{key:"compile",value:function compile(params){return this._compile(params)}},{key:"parse",value:function parse(path){var childPath=undefined;var hash=undefined;var params={};var hIndex=path.indexOf("#");if(~hIndex){var parts=path.split("#");path=parts[0];hash=utils.decodeURLEncodedURIComponent(parts[1])||""}var qsIndex=path.indexOf("?");var pathname=~qsIndex?path.slice(0,qsIndex):path;var matches=this._regexp.exec(decodeURIComponent(pathname));for(var i=1,len=matches.length;i<len;++i){var k=this._keys[i-1];var v=utils.decodeURLEncodedURIComponent(matches[i]);if(v!==undefined||!hasOwnProperty.call(params,k.name)){if(k.name==="child_path"){childPath="/"+v;path=path.replace(childPath,"")}else{params[k.name]=v}}}return[path,params,hash,pathname]}}]);return Route}();module.exports=Route},function(module,exports,__webpack_require__){var isarray=__webpack_require__(7);module.exports=pathToRegexp;module.exports.parse=parse;module.exports.compile=compile;module.exports.tokensToFunction=tokensToFunction;module.exports.tokensToRegExp=tokensToRegExp;var PATH_REGEXP=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function parse(str){var tokens=[];var key=0;var index=0;var path="";var res;while((res=PATH_REGEXP.exec(str))!=null){var m=res[0];var escaped=res[1];var offset=res.index;path+=str.slice(index,offset);index=offset+m.length;if(escaped){path+=escaped[1];continue}if(path){tokens.push(path);path=""}var prefix=res[2];var name=res[3];var capture=res[4];var group=res[5];var suffix=res[6];var asterisk=res[7];var repeat=suffix==="+"||suffix==="*";var optional=suffix==="?"||suffix==="*";var delimiter=prefix||"/";var pattern=capture||group||(asterisk?".*":"[^"+delimiter+"]+?");tokens.push({name:name||key++,prefix:prefix||"",delimiter:delimiter,optional:optional,repeat:repeat,pattern:escapeGroup(pattern)})}if(index<str.length){path+=str.substr(index)}if(path){tokens.push(path)}return tokens}function compile(str){return tokensToFunction(parse(str))}function tokensToFunction(tokens){var matches=new Array(tokens.length);for(var i=0;i<tokens.length;i++){if(typeof tokens[i]==="object"){matches[i]=new RegExp("^"+tokens[i].pattern+"$")}}return function(obj){var path="";var data=obj||{};for(var i=0;i<tokens.length;i++){var token=tokens[i];if(typeof token==="string"){path+=token;continue}var value=data[token.name];var segment;if(value==null){if(token.optional){continue}else{throw new TypeError('Expected "'+token.name+'" to be defined')}}if(isarray(value)){if(!token.repeat){throw new TypeError('Expected "'+token.name+'" to not repeat, but received "'+value+'"')}if(value.length===0){if(token.optional){continue}else{throw new TypeError('Expected "'+token.name+'" to not be empty')}}for(var j=0;j<value.length;j++){segment=encodeURIComponent(value[j]);if(!matches[i].test(segment)){throw new TypeError('Expected all "'+token.name+'" to match "'+token.pattern+'", but received "'+segment+'"')}path+=(j===0?token.prefix:token.delimiter)+segment}continue}segment=encodeURIComponent(value);if(!matches[i].test(segment)){throw new TypeError('Expected "'+token.name+'" to match "'+token.pattern+'", but received "'+segment+'"')}path+=token.prefix+segment}return path}}function escapeString(str){return str.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")}function escapeGroup(group){return group.replace(/([=!:$\/()])/g,"\\$1")}function attachKeys(re,keys){re.keys=keys;return re}function flags(options){return options.sensitive?"":"i"}function regexpToRegexp(path,keys){var groups=path.source.match(/\((?!\?)/g);if(groups){for(var i=0;i<groups.length;i++){keys.push({name:i,prefix:null,delimiter:null,optional:false,repeat:false,pattern:null})}}return attachKeys(path,keys)}function arrayToRegexp(path,keys,options){var parts=[];for(var i=0;i<path.length;i++){parts.push(pathToRegexp(path[i],keys,options).source)}var regexp=new RegExp("(?:"+parts.join("|")+")",flags(options));return attachKeys(regexp,keys)}function stringToRegexp(path,keys,options){var tokens=parse(path);var re=tokensToRegExp(tokens,options);for(var i=0;i<tokens.length;i++){if(typeof tokens[i]!=="string"){keys.push(tokens[i])}}return attachKeys(re,keys)}function tokensToRegExp(tokens,options){options=options||{};var strict=options.strict;var end=options.end!==false;var route="";var lastToken=tokens[tokens.length-1];var endsWithSlash=typeof lastToken==="string"&&/\/$/.test(lastToken);for(var i=0;i<tokens.length;i++){var token=tokens[i];if(typeof token==="string"){route+=escapeString(token)}else{var prefix=escapeString(token.prefix);var capture=token.pattern;if(token.repeat){capture+="(?:"+prefix+capture+")*"}if(token.optional){if(prefix){capture="(?:"+prefix+"("+capture+"))?"}else{capture="("+capture+")?"}}else{capture=prefix+"("+capture+")"}route+=capture}}if(!strict){route=(endsWithSlash?route.slice(0,-2):route)+"(?:\\/(?=$))?"}if(end){route+="$"}else{route+=strict&&endsWithSlash?"":"(?=\\/|$)"}return new RegExp("^"+route,flags(options))}function pathToRegexp(path,keys,options){keys=keys||[];if(!isarray(keys)){options=keys;keys=[]}else if(!options){options={}}if(path instanceof RegExp){return regexpToRegexp(path,keys,options)}if(isarray(path)){return arrayToRegexp(path,keys,options)}return stringToRegexp(path,keys,options)}},function(module,exports){module.exports=Array.isArray||function(arr){return Object.prototype.toString.call(arr)=="[object Array]"}}])});