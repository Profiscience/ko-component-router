!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("knockout")):"function"==typeof define&&define.amd?define(["knockout"],t):"object"==typeof exports?exports["ko-component-router"]=t(require("knockout")):e["ko-component-router"]=t(e.ko)}(this,function(e){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1),o=r(i),a=n(2),u=r(a);n(14),o["default"].components.register("__KO_ROUTER_EMPTY_COMPONENT__",{template:"<span></span>"}),o["default"].components.register("ko-component-router",{synchronous:!0,viewModel:u["default"],template:"<div data-bind='if: ctx.route().component'>\n      <div class=\"component-wrapper\" data-bind='component: {\n        name: ctx.route().component,\n        params: ctx\n      }'></div>\n    </div>"})},function(t,n){t.exports=e},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){var n=t.element,r=f["default"].contextFor(n);return new m(n,r,f["default"].toJS(e))}function a(e){return e=e||window.event,null===e.which?e.button:e.which}function u(){}function s(e){var t=location.protocol+"//"+location.hostname;return location.port&&(t+=":"+location.port),e&&0===e.indexOf(t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(1),f=r(c),p=n(3),d=r(p),h=n(11),v=r(h),y=n(9),g=!(0,y.isUndefined)(document)&&document.ontouchstart?"touchstart":"click",m=function(){function e(t,n,r){var o=r.routes,a=r.base,s=void 0===a?"":a,l=r.hashbang,c=void 0!==l&&l,f=r.inTransition,p=void 0===f?u:f,h=r.outTransition,y=void 0===h?u:h,m=r.persistState,b=void 0!==m&&m,x=r.persistQuery,w=void 0!==x&&x;i(this,e);for(var k in o)o[k]=new v["default"](k,o[k]);this.config={el:t,base:s,hashbang:c,routes:o,inTransition:p,outTransition:y,persistState:b,persistQuery:w},this.ctx=new d["default"](n,this.config),this.onpopstate=this.onpopstate.bind(this),this.onclick=this.onclick.bind(this),window.addEventListener("popstate",this.onpopstate,!1),document.addEventListener(g,this.onclick,!1);var O=!0;if(this.ctx.$parent&&(O=this.ctx.$parent.path()!==this.ctx.$parent.canonicalPath()),O){var _=this.config.hashbang&&~location.hash.indexOf("#!")?location.hash.substr(2)+location.search:location.pathname+location.search+location.hash;this.dispatch({path:_})}}return l(e,[{key:"dispatch",value:function(e){for(var t=e.path,n=e.state,r=e.pushState,i=void 0!==r&&r,o=this.ctx;o.$child;)o=o.$child;return 0===t.toLowerCase().indexOf(o.config.base.toLowerCase())&&(t=t.substr(o.config.base.length)||"/"),o.update(t,n,i,!1)}},{key:"onpopstate",value:function(e){if(!e.defaultPrevented){var t=location.pathname+location.search+location.hash,n=(e.state||{})[this.ctx.config.depth+this.ctx.pathname()];this.dispatch({path:t,state:n})&&e.preventDefault()}}},{key:"onclick",value:function(e){for(var t=e.target;t&&"A"!==t.nodeName;)t=t.parentNode;if(t&&"A"===t.nodeName){var n=1!==a(e),r=e.metaKey||e.ctrlKey||e.shiftKey,i=t.hasAttribute("download"),o=t.hasAttribute("target"),u="external"===t.getAttribute("rel"),l=~(t.getAttribute("href")||"").indexOf("mailto:"),c=!s(t.href),f="#"===t.getAttribute("href");if(!(c||n||i||f||l||u||r||o)){var p=t.pathname+t.search+(t.hash||"");this.dispatch({path:p,pushState:!0})&&e.preventDefault()}}}},{key:"dispose",value:function(){document.removeEventListener(g,this.onclick,!1),window.removeEventListener("popstate",this.onpopstate,!1),this.ctx.destroy()}}]),e}();t["default"]={createViewModel:o}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(s){i=!0,o=s}finally{try{!r&&u["return"]&&u["return"]()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),s=r(u),l=n(4),c=r(l),f=n(8),p=n(10),d=n(9),h=function(){function e(t,n){i(this,e),t.$router=this;for(var r=t,o=!0;r.$parentContext;){if(r=r.$parentContext,r.$router){o=!1;break}r.$router=this}o?s["default"].router=this:(this.$parent=r.$router,this.$parent.$child=this,n.base=this.$parent.pathname()),this.config=n,this.config.depth=e.getDepth(this),this.isNavigating=s["default"].observable(!0),this.route=s["default"].observable(""),this.canonicalPath=s["default"].observable(""),this.path=s["default"].observable(""),this.pathname=s["default"].observable(""),this.hash=s["default"].observable(""),this.params={},this.query=(0,f.factory)(this),this.state=(0,p.factory)(this),this._beforeNavigateCallbacks=[]}return a(e,[{key:"update",value:function(e,t,n){var r=this;if(this._queuedArgs){var i=o(this._queuedArgs,3),a=i[2];arguments[2]=a||n}return this._queuedArgs=arguments,this._queuedUpdate?this._queuedUpdate:this._queuedUpdate=new Promise(function(e){s["default"].tasks.schedule(function(){r._update.apply(r,r._queuedArgs).then(e),r._queuedUpdate=!1})})}},{key:"_update",value:function(){var t=arguments.length<=0||void 0===arguments[0]?this.canonicalPath():arguments[0],n=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],r=arguments.length<=2||void 0===arguments[2]||arguments[2],i=this,a=!(arguments.length<=3||void 0===arguments[3])&&arguments[3],u=!(arguments.length<=4||void 0===arguments[4])&&arguments[4],l=this.resolveUrl(t),f=this.getRouteForUrl(l),p=""===this.route();if(!f){var h;return this.$parent?(h=this.$parent).update.apply(h,arguments):Promise.resolve(!1)}var v=this.toJS(),y=f.parse(l),g=o(y,6),m=g[0],b=g[1],x=g[2],w=g[3],k=g[4],O=g[5],_=this.pathname()===w,j=_?this.$child?this.$child.update(O||"/",!!u&&n,!1,!!u&&a):Promise.resolve(!0):this.runBeforeNavigateCallbacks();return j.then(function(t){if(!t)return Promise.resolve(!1);(!_&&!p||i.config._forceReload)&&(i.isNavigating(!0),i.reload(),i._beforeNavigateCallbacks=[]),!a&&k&&(a=c["default"].parse(k)[i.config.depth+w]);var o=e.getCanonicalPath(i.getBase().replace(/\/$/,""),w,O,i.query.getFullQueryString(a,w),x),l={path:m,pathname:w,canonicalPath:o,hash:x,params:b,query:a,route:f};return n===!1&&_?l.state=v.state:!i.config.persistState&&n&&(l.state=n),i.config.persistState&&(l.state=i.state()),_&&(0,d.deepEquals)(v.query,l.query)||history[r?"pushState":"replaceState"](history.state,document.title,""===o?i.getBase():o),new Promise(function(e){var t=function(t){var r=i.config.el.getElementsByClassName("component-wrapper")[0];delete l.query,l.route.runPipeline(l).then(function(){if(v.route.component===l.route.component)if(i.config._forceReload){var o=l.route;i.config._forceReload=!1,l.route={component:"__KO_ROUTER_EMPTY_COMPONENT__"},(0,d.extend)(i,l),s["default"].tasks.runEarly(),i.route(o)}else(0,d.merge)(i,l);else(0,d.extend)(i,l);a&&i.query.update(a,w),i.isNavigating(!1),s["default"].tasks.runEarly(),e(!0),t&&s["default"].tasks.schedule(function(){return i.config.inTransition(r,v,l)}),i.$child&&i.$child.update(O||"/",!!u&&n,!1,!!u&&a)})};p||_?t(p):_||(i.config.outTransition(i.config.el,v,l,t),4!==i.config.outTransition.length&&t(!0))})})}},{key:"addBeforeNavigateCallback",value:function(e){this._beforeNavigateCallbacks.push(e)}},{key:"runBeforeNavigateCallbacks",value:function(){for(var e=this,t=[];e;)t=e._beforeNavigateCallbacks.concat(t),e=e.$child;return(0,d.cascade)(t)}},{key:"forceReloadOnParamChange",value:function(){this.config._forceReload=!0}},{key:"getRouteForUrl",value:function(e){var t=e.split("#")[0].split("?")[0],n=void 0,r=1/0;for(var i in this.config.routes){var o=this.config.routes[i];if(o.matches(t)){if(0===o._keys.length)return o;(r===1/0||o._keys.length<r&&".*"!==o._keys[0].pattern)&&(r=o._keys.length,n=o)}}return n}},{key:"destroy",value:function(){this.$child&&(this.$child.destroy(),delete this.$child),this.query.dispose(),this.state.dispose()}},{key:"reload",value:function(){this.$child&&(this.$child.destroy(),delete this.$child),this.query.reload(),this.state.reload()}},{key:"resolveUrl",value:function(e){var t=(e+"").replace("/#!","");if(0===t.indexOf("./"))t=t.replace("./","/");else for(var n=this;n&&t.indexOf(n.config.base)>-1;)t=t.replace(n.config.base,""),n=n.$parent;return t}},{key:"toJS",value:function(){return s["default"].toJS({route:this.route,path:this.path,pathname:this.pathname,canonicalPath:this.canonicalPath,hash:this.hash,state:this.state,params:this.params,query:this.query.getAll(!1,this.pathname())})}},{key:"getBase",value:function(){for(var e="",t=this;t;)e=t.config.base+(!t.config.hashbang||t.$parent?"":"/#!")+e,t=t.$parent;return e}}],[{key:"getCanonicalPath",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?"":arguments[2],r=arguments[3],i=arguments.length<=4||void 0===arguments[4]?"":arguments[4];return""+e+t+n+(r?"?"+r:"")+(i?"#"+i:"")}},{key:"getDepth",value:function(e){for(var t=0;e.$parent;)e=e.$parent,t++;return t}}]),e}();t["default"]=h},function(e,t,n){"use strict";var r=n(5),i=n(7);e.exports={stringify:r,parse:i}},function(e,t,n){"use strict";var r=n(6),i={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},o={delimiter:"&",strictNullHandling:!1,skipNulls:!1,encode:!0,encoder:r.encode},a=function u(e,t,n,i,o,a,s,l,c){var f=e;if("function"==typeof s)f=s(t,f);else if(f instanceof Date)f=f.toISOString();else if(null===f){if(i)return a?a(t):t;f=""}if("string"==typeof f||"number"==typeof f||"boolean"==typeof f||r.isBuffer(f))return a?[a(t)+"="+a(f)]:[t+"="+String(f)];var p=[];if("undefined"==typeof f)return p;var d;if(Array.isArray(s))d=s;else{var h=Object.keys(f);d=l?h.sort(l):h}for(var v=0;v<d.length;++v){var y=d[v];o&&null===f[y]||(p=Array.isArray(f)?p.concat(u(f[y],n(t,y),n,i,o,a,s,l,c)):p.concat(u(f[y],t+(c?"."+y:"["+y+"]"),n,i,o,a,s,l,c)))}return p};e.exports=function(e,t){var n,r,u=e,s=t||{},l="undefined"==typeof s.delimiter?o.delimiter:s.delimiter,c="boolean"==typeof s.strictNullHandling?s.strictNullHandling:o.strictNullHandling,f="boolean"==typeof s.skipNulls?s.skipNulls:o.skipNulls,p="boolean"==typeof s.encode?s.encode:o.encode,d=p?"function"==typeof s.encoder?s.encoder:o.encoder:null,h="function"==typeof s.sort?s.sort:null,v="undefined"!=typeof s.allowDots&&s.allowDots;if(null!==s.encoder&&void 0!==s.encoder&&"function"!=typeof s.encoder)throw new TypeError("Encoder has to be a function.");"function"==typeof s.filter?(r=s.filter,u=r("",u)):Array.isArray(s.filter)&&(n=r=s.filter);var y=[];if("object"!=typeof u||null===u)return"";var g;g=s.arrayFormat in i?s.arrayFormat:"indices"in s?s.indices?"indices":"repeat":"indices";var m=i[g];n||(n=Object.keys(u)),h&&n.sort(h);for(var b=0;b<n.length;++b){var x=n[b];f&&null===u[x]||(y=y.concat(a(u[x],x,m,c,f,d,r,h,v)))}return y.join(l)}},function(e,t){"use strict";var n=function(){for(var e=new Array(256),t=0;t<256;++t)e[t]="%"+((t<16?"0":"")+t.toString(16)).toUpperCase();return e}();t.arrayToObject=function(e,t){for(var n=t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)"undefined"!=typeof e[r]&&(n[r]=e[r]);return n},t.merge=function(e,n,r){if(!n)return e;if("object"!=typeof n){if(Array.isArray(e))e.push(n);else{if("object"!=typeof e)return[e,n];e[n]=!0}return e}if("object"!=typeof e)return[e].concat(n);var i=e;return Array.isArray(e)&&!Array.isArray(n)&&(i=t.arrayToObject(e,r)),Object.keys(n).reduce(function(e,i){var o=n[i];return Object.prototype.hasOwnProperty.call(e,i)?e[i]=t.merge(e[i],o,r):e[i]=o,e},i)},t.decode=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},t.encode=function(e){if(0===e.length)return e;for(var t="string"==typeof e?e:String(e),r="",i=0;i<t.length;++i){var o=t.charCodeAt(i);45===o||46===o||95===o||126===o||o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122?r+=t.charAt(i):o<128?r+=n[o]:o<2048?r+=n[192|o>>6]+n[128|63&o]:o<55296||o>=57344?r+=n[224|o>>12]+n[128|o>>6&63]+n[128|63&o]:(i+=1,o=65536+((1023&o)<<10|1023&t.charCodeAt(i)),r+=n[240|o>>18]+n[128|o>>12&63]+n[128|o>>6&63]+n[128|63&o])}return r},t.compact=function(e,n){if("object"!=typeof e||null===e)return e;var r=n||[],i=r.indexOf(e);if(i!==-1)return r[i];if(r.push(e),Array.isArray(e)){for(var o=[],a=0;a<e.length;++a)e[a]&&"object"==typeof e[a]?o.push(t.compact(e[a],r)):"undefined"!=typeof e[a]&&o.push(e[a]);return o}for(var u=Object.keys(e),s=0;s<u.length;++s){var l=u[s];e[l]=t.compact(e[l],r)}return e},t.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},t.isBuffer=function(e){return null!==e&&"undefined"!=typeof e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}},function(e,t,n){"use strict";var r=n(6),i=Object.prototype.hasOwnProperty,o={delimiter:"&",depth:5,arrayLimit:20,parameterLimit:1e3,strictNullHandling:!1,plainObjects:!1,allowPrototypes:!1,allowDots:!1,decoder:r.decode},a=function(e,t){for(var n={},r=e.split(t.delimiter,t.parameterLimit===1/0?void 0:t.parameterLimit),o=0;o<r.length;++o){var a,u,s=r[o],l=s.indexOf("]=")===-1?s.indexOf("="):s.indexOf("]=")+1;l===-1?(a=t.decoder(s),u=t.strictNullHandling?null:""):(a=t.decoder(s.slice(0,l)),u=t.decoder(s.slice(l+1))),i.call(n,a)?n[a]=[].concat(n[a]).concat(u):n[a]=u}return n},u=function l(e,t,n){if(!e.length)return t;var r,i=e.shift();if("[]"===i)r=[],r=r.concat(l(e,t,n));else{r=n.plainObjects?Object.create(null):{};var o="["===i[0]&&"]"===i[i.length-1]?i.slice(1,i.length-1):i,a=parseInt(o,10);!isNaN(a)&&i!==o&&String(a)===o&&a>=0&&n.parseArrays&&a<=n.arrayLimit?(r=[],r[a]=l(e,t,n)):r[o]=l(e,t,n)}return r},s=function(e,t,n){if(e){var r=n.allowDots?e.replace(/\.([^\.\[]+)/g,"[$1]"):e,o=/^([^\[\]]*)/,a=/(\[[^\[\]]*\])/g,s=o.exec(r),l=[];if(s[1]){if(!n.plainObjects&&i.call(Object.prototype,s[1])&&!n.allowPrototypes)return;l.push(s[1])}for(var c=0;null!==(s=a.exec(r))&&c<n.depth;)c+=1,(n.plainObjects||!i.call(Object.prototype,s[1].replace(/\[|\]/g,""))||n.allowPrototypes)&&l.push(s[1]);return s&&l.push("["+r.slice(s.index)+"]"),u(l,t,n)}};e.exports=function(e,t){var n=t||{};if(null!==n.decoder&&void 0!==n.decoder&&"function"!=typeof n.decoder)throw new TypeError("Decoder has to be a function.");if(n.delimiter="string"==typeof n.delimiter||r.isRegExp(n.delimiter)?n.delimiter:o.delimiter,n.depth="number"==typeof n.depth?n.depth:o.depth,n.arrayLimit="number"==typeof n.arrayLimit?n.arrayLimit:o.arrayLimit,n.parseArrays=n.parseArrays!==!1,n.decoder="function"==typeof n.decoder?n.decoder:o.decoder,n.allowDots="boolean"==typeof n.allowDots?n.allowDots:o.allowDots,n.plainObjects="boolean"==typeof n.plainObjects?n.plainObjects:o.plainObjects,n.allowPrototypes="boolean"==typeof n.allowPrototypes?n.allowPrototypes:o.allowPrototypes,n.parameterLimit="number"==typeof n.parameterLimit?n.parameterLimit:o.parameterLimit,n.strictNullHandling="boolean"==typeof n.strictNullHandling?n.strictNullHandling:o.strictNullHandling,""===e||null===e||"undefined"==typeof e)return n.plainObjects?Object.create(null):{};for(var i="string"==typeof e?a(e,n):e,u=n.plainObjects?Object.create(null):{},l=Object.keys(i),c=0;c<l.length;++c){var f=l[c],p=s(f,i[f],n);u=r.merge(u,p,n)}return r.compact(u)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){return new y(e)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.factory=a;var s=n(1),l=r(s),c=n(4),f=r(c),p=n(9),d={},h=l["default"].observable(!0),v={},y=function(){function e(t){if(o(this,e),this.ctx=t,!this.ctx.$parent){var n=window.location.href.indexOf("?");~n&&this.updateFromString(window.location.href.split("?")[1])}this.get=this.get.bind(this),this.clear=this.clear.bind(this),this.update=this.update.bind(this)}return u(e,[{key:"get",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?p.identity:arguments[2],r=this,o=this.ctx,a=this.ctx.config.depth+o.pathname();return v[a]||(v[a]={}),v[a][e]||(v[a][e]={parser:n,value:l["default"].pureComputed({read:function(){return h(),d&&d[a]&&!(0,p.isUndefined)(d[a][e])?v[a][e].parser(d[a][e]):t},write:function(t){var n=location,u=n.pathname,s=n.hash;(0,p.deepEquals)(t,this.prev)||(this.prev=t,(0,p.merge)(d,i({},a,i({},e,t)),!1),o.update(u+s,o.state(),!1,r.getNonDefaultParams()[a]).then(function(){return h(!h())}))},owner:{prev:null}})}),t&&(v[a][e].defaultVal=(0,p.clone)(t),d&&d[a]&&(0,p.isUndefined)(d[a][e])&&this.get(e)(t)),v[a][e].value}},{key:"getAll",value:function(){var e=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],t=arguments.length<=1||void 0===arguments[1]?this.ctx.pathname():arguments[1],n=this.ctx.config.depth+t;return e?l["default"].pureComputed({read:function(){return h(),this.getAll()},write:function(e){for(var t in e)this.get(t)(e[t])}},this):l["default"].toJS((0,p.mapKeys)(d[n]||{},function(e){return v[n]&&v[n][e]?(0,p.isUndefined)(d[n][e])?void 0:v[n][e].parser(d[n][e]):d[n][e]}))}},{key:"setDefaults",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?p.identity:arguments[1];for(var n in e)this.get(n,e[n],t)}},{key:"clear",value:function(e){"string"!=typeof e&&(e=this.ctx.pathname());var t=this.ctx.config.depth+e;for(var n in v[t]){var r=v[t][n];this.get(n)(r.defaultVal)}}},{key:"reload",value:function(){var e=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],t=arguments.length<=1||void 0===arguments[1]?this.ctx.config.depth+this.ctx.pathname():arguments[1];if(!this.ctx.config.persistQuery||e){for(var n in d[t])v[t]&&v[t][n]&&v[t][n].value.dispose();delete d[t],delete v[t]}h(!h())}},{key:"dispose",value:function(){for(var e in d)0===e.indexOf(this.ctx.config.depth)&&this.reload(!0,e)}},{key:"update",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=arguments.length<=1||void 0===arguments[1]?this.ctx.pathname():arguments[1],n=this.ctx.config.depth+t;(0,p.deepEquals)(d[n],e)||((0,p.merge)(d,i({},n,e),!1),h(!h()))}},{key:"updateFromString",value:function(e,t){if(t){var n=this.ctx.config.depth+t;(0,p.merge)(d,i({},n,f["default"].parse(e)[n]),!1)}else(0,p.merge)(d,f["default"].parse(e),!1);h(!h())}},{key:"getNonDefaultParams",value:function(e,t){var n={},r=d;e&&(0,p.merge)(r,i({},this.ctx.config.depth+t,e),!1);for(var o in r)if(v[o]){n[o]={};for(var a in r[o]){var u=r[o][a],s=v[o][a],l=s&&s.defaultVal;(0,p.isUndefined)(u)||(0,p.deepEquals)(u,l)||(n[o][a]=u)}}else n[o]=r[o];return n}},{key:"getFullQueryString",value:function(e,t){return f["default"].stringify(this.getNonDefaultParams(e,t))}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new Promise(function(t){if(0===e.length)return t(!0);var r=e.shift(),o=function(){var r=arguments.length<=0||void 0===arguments[0]||arguments[0];return r?i.apply(void 0,[e].concat(n)).then(t):t(!1)};if(r.length===n.length+1)r.apply(void 0,n.concat([o]));else{var a=r.apply(void 0,n);c(a)||"function"!=typeof a.then?o(a):a.then(o)}})}function o(e){return d(e)?e.slice(0):p(e)?s({},e,!1):e}function a(e){return"string"!=typeof e?e:decodeURIComponent(e.replace(/\+/g," "))}function u(e,t){if(null===e||null===t)return null===e&&null===t;if(("undefined"==typeof e?"undefined":m(e))!==("undefined"==typeof t?"undefined":m(t)))return!1;if(c(e))return c(t);if(g(e)&&g(t))return e===t;if(e.constructor===Object&&t.constructor===Object){var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;var i=!0,o=!1,a=void 0;try{for(var s,l=n[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var f=s.value;if(!u(e[f],t[f]))return!1}}catch(p){o=!0,a=p}finally{try{!i&&l["return"]&&l["return"]()}finally{if(o)throw a}}return!0}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;var d=!0,h=!1,v=void 0;try{for(var y,b=e[Symbol.iterator]();!(d=(y=b.next()).done);d=!0){var x=y.value;if(t.indexOf(x)<0)return!1}}catch(p){h=!0,v=p}finally{try{!d&&b["return"]&&b["return"]()}finally{if(h)throw v}}return!0}return e===t}function s(e,t){var n=arguments.length<=2||void 0===arguments[2]||arguments[2],r=arguments.length<=3||void 0===arguments[3]||arguments[3],i=Object.keys(t),o=!0,a=!1,l=void 0;try{for(var f,h=i[Symbol.iterator]();!(o=(f=h.next()).done);o=!0){var v=f.value;c(e[v])?e[v]=n?y(t[v]):t[v]:x["default"].isWritableObservable(e[v])?u(e[v](),t[v])||e[v](t[v]):c(t[v])?e[v]=void 0:p(t[v])?(r&&(e[v]={}),s(e[v],t[v],n)):d(t[v])?e[v]=t[v].slice(0):e[v]=t[v]}}catch(g){a=!0,l=g}finally{try{!o&&h["return"]&&h["return"]()}finally{if(a)throw l}}return e}function l(e){return e}function c(e){return"undefined"==typeof e}function f(e){return"function"==typeof e}function p(e){return e.constructor===Object}function d(e){return f(e.splice)}function h(e,t){var n={};return Object.keys(e).forEach(function(e){return n[e]=t(e)}),n}function v(e,t){var n=arguments.length<=2||void 0===arguments[2]||arguments[2];s(e,t,n,!1)}function y(e,t){var n=void 0;if(g(e))n=t?e:x["default"].observable(e);else if(e instanceof Array){n=[];for(var r=0;r<e.length;r++)n[r]=y(e[r],!0);n=x["default"].observableArray(n)}else if(e.constructor===Object){n={};for(var i in e)n[i]=y(e[i])}return n}function g(e){return null===e||void 0===e||e.constructor===String||e.constructor===Number||e.constructor===Boolean||e instanceof Date}Object.defineProperty(t,"__esModule",{value:!0});var m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};t.cascade=i,t.clone=o,t.decodeURLEncodedURIComponent=a,t.deepEquals=u,t.extend=s,t.identity=l,t.isUndefined=c,t.isFunction=f,t.isPlainObject=p,t.isArray=d,t.mapKeys=h,t.merge=v;var b=n(1),x=r(b)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){var t=a["default"].observable(!1),n=a["default"].pureComputed({read:function(){return t(),history.state?history.state[e.config.depth+e.pathname()]:{}},write:function(n){if(n){var r=history.state||{},i=e.config.depth+e.pathname();(0,u.deepEquals)(n,history.state?history.state[e.config.depth+e.pathname()]:{})||(r[i]&&delete r[i],r[i]=n,history.replaceState(r,document.title),t(!t()))}}}),r=n.dispose;return n.reload=function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],n=arguments.length<=1||void 0===arguments[1]?e.config.depth+e.pathname():arguments[1];if((!e.config.persistState||t)&&history.state&&history.state[n]){var r=history.state;delete r[n]}},n.dispose=function(){for(var t in history.state)0===t.indexOf(e.config.depth)&&n.reload(!0,t);r.apply(n,arguments)},n}Object.defineProperty(t,"__esModule",{value:!0}),t.factory=i;var o=n(1),a=r(o),u=n(9)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(s){i=!0,o=s}finally{try{!r&&u["return"]&&u["return"]()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(12),s=r(u),l=n(9),c=function(){function e(t,n){i(this,e),t="!"===t[t.length-1]?t.replace("!",":child_path(.*)?"):t.replace(/\(?\*\)?/,"(.*)"),"string"==typeof n?(this.component=n,this.pipeline=[]):"string"==typeof n[n.length-1]?(this.component=n.pop(),this.pipeline=n):this.pipeline=n,this._keys=[],this._regexp=(0,s["default"])(t,this._keys)}return a(e,[{key:"matches",value:function(e){var t=e.indexOf("?");return~t&&(e=e.split("?")[0]),this._regexp.exec(decodeURIComponent(e))}},{key:"parse",value:function(e){var t=void 0,n="",r={},i=e.indexOf("#");if(~i){var a=e.split("#");e=a[0],n=(0,l.decodeURLEncodedURIComponent)(a[1])}for(var u=e.indexOf("?"),s=~u?e.split("?"):[e],c=o(s,2),f=c[0],p=c[1],d=this._regexp.exec(decodeURIComponent(f)),h=1,v=d.length;h<v;++h){var y=this._keys[h-1],g=(0,l.decodeURLEncodedURIComponent)(d[h]);!(0,l.isUndefined)(g)&&hasOwnProperty.call(r,y.name)||("child_path"===y.name?(0,l.isUndefined)(g)||(t="/"+g,e=e.substring(0,e.lastIndexOf(t)),f=f.substring(0,f.lastIndexOf(t))):r[y.name]=g)}return[e,r,n,f,p,t]}},{key:"runPipeline",value:function(e){return(0,l.cascade)(this.pipeline,e)}}]),e}();t["default"]=c},function(e,t,n){function r(e){for(var t,n=[],r=0,i=0,o="";null!=(t=m.exec(e));){var a=t[0],u=t[1],s=t.index;if(o+=e.slice(i,s),i=s+a.length,u)o+=u[1];else{var c=e[i],f=t[2],p=t[3],d=t[4],h=t[5],v=t[6],y=t[7];o&&(n.push(o),o="");var g=null!=f&&null!=c&&c!==f,b="+"===v||"*"===v,x="?"===v||"*"===v,w=t[2]||"/",k=d||h||(y?".*":"[^"+w+"]+?");n.push({name:p||r++,prefix:f||"",delimiter:w,optional:x,repeat:b,partial:g,asterisk:!!y,pattern:l(k)})}}return i<e.length&&(o+=e.substr(i)),o&&n.push(o),n}function i(e){return u(r(e))}function o(e){return encodeURI(e).replace(/[\/?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function a(e){return encodeURI(e).replace(/[?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function u(e){for(var t=new Array(e.length),n=0;n<e.length;n++)"object"==typeof e[n]&&(t[n]=new RegExp("^(?:"+e[n].pattern+")$"));return function(n,r){for(var i="",u=n||{},s=r||{},l=s.pretty?o:encodeURIComponent,c=0;c<e.length;c++){var f=e[c];if("string"!=typeof f){var p,d=u[f.name];if(null==d){if(f.optional){f.partial&&(i+=f.prefix);continue}throw new TypeError('Expected "'+f.name+'" to be defined')}if(g(d)){if(!f.repeat)throw new TypeError('Expected "'+f.name+'" to not repeat, but received `'+JSON.stringify(d)+"`");if(0===d.length){if(f.optional)continue;throw new TypeError('Expected "'+f.name+'" to not be empty')}for(var h=0;h<d.length;h++){if(p=l(d[h]),!t[c].test(p))throw new TypeError('Expected all "'+f.name+'" to match "'+f.pattern+'", but received `'+JSON.stringify(p)+"`");i+=(0===h?f.prefix:f.delimiter)+p}}else{if(p=f.asterisk?a(d):l(d),!t[c].test(p))throw new TypeError('Expected "'+f.name+'" to match "'+f.pattern+'", but received "'+p+'"');i+=f.prefix+p}}else i+=f}return i}}function s(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function l(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function c(e,t){return e.keys=t,e}function f(e){return e.sensitive?"":"i"}function p(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return c(e,t)}function d(e,t,n){for(var r=[],i=0;i<e.length;i++)r.push(y(e[i],t,n).source);var o=new RegExp("(?:"+r.join("|")+")",f(n));return c(o,t)}function h(e,t,n){for(var i=r(e),o=v(i,n),a=0;a<i.length;a++)"string"!=typeof i[a]&&t.push(i[a]);return c(o,t)}function v(e,t){t=t||{};for(var n=t.strict,r=t.end!==!1,i="",o=e[e.length-1],a="string"==typeof o&&/\/$/.test(o),u=0;u<e.length;u++){var l=e[u];if("string"==typeof l)i+=s(l);else{var c=s(l.prefix),p="(?:"+l.pattern+")";l.repeat&&(p+="(?:"+c+p+")*"),p=l.optional?l.partial?c+"("+p+")?":"(?:"+c+"("+p+"))?":c+"("+p+")",i+=p}}return n||(i=(a?i.slice(0,-2):i)+"(?:\\/(?=$))?"),i+=r?"$":n&&a?"":"(?=\\/|$)",new RegExp("^"+i,f(t))}function y(e,t,n){return t=t||[],g(t)?n||(n={}):(n=t,t=[]),e instanceof RegExp?p(e,t):g(e)?d(e,t,n):h(e,t,n)}var g=n(13);e.exports=y,e.exports.parse=r,e.exports.compile=i,e.exports.tokensToFunction=u,e.exports.tokensToRegExp=v;var m=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g")},function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,n){for(var r=a(e,t),i=l(r,2),o=i[0],u=i[1],s=n?"?"+d["default"].stringify(f["default"].toJS(n)):"";o.$parent;)u=o.config.base+u,o=o.$parent;return o?o.config.base+(!o.config.hashbang||o.$parent?"":"/#!")+u+s:"#"}function o(e,t,n){var r=!!t.has("path")&&t.get("path"),o=!!t.has("query")&&t.get("query"),u=!!t.has("state")&&t.get("state"),c={};e.href="#",c.click=function(t,i){var c=1!==s(i),p=e.hasAttribute("target"),d="external"===e.getAttribute("rel"),h=i.metaKey||i.ctrlKey||i.shiftKey;if(c||p||d||h)return!0;var v=a(n,r),y=l(v,2),g=y[0],m=y[1],b=g.update(m,f["default"].toJS(u),!0,f["default"].toJS(o),!0);return b?(i.preventDefault(),i.stopImmediatePropagation()):g.$parent||console.error("[ko-component-router] "+r+" did not match any routes!"),!b},c.attr={href:f["default"].pureComputed(function(){return i(n,t.get("path"),o)})},r&&(c.css={"active-path":f["default"].pureComputed(function(){var e=a(n,r),t=l(e,2),i=t[0],o=t[1];return!(i.isNavigating()||""===i.route()||!o)&&i.route().matches(o)})}),f["default"].tasks.schedule(function(){return f["default"].applyBindingsToNode(e,c)})}function a(e,t){var n=u(e),r=t?f["default"].unwrap(t):n.canonicalPath();if(0===r.indexOf("//"))for(r=r.replace("//","/");n.$parent;)n=n.$parent;else for(;r&&r.match(/\/?\.\./i)&&n.$parent;)n=n.$parent,r=r.replace(/\/?\.\./i,"");return[n,r]}function u(e){for(;!(0,h.isUndefined)(e);){if(!(0,h.isUndefined)(e.$router))return e.$router;e=e.$parentContext}}function s(e){return e=e||window.event,null===e.which?e.button:e.which}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(s){i=!0,o=s}finally{try{!r&&u["return"]&&u["return"]()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.resolveHref=i;var c=n(1),f=r(c),p=n(4),d=r(p),h=n(9);f["default"].bindingHandlers.path={init:function(e,t,n,r,i){o.call(this,e,n,i)}},f["default"].bindingHandlers.state={init:function(e,t,n,r,i){o.call(this,e,n,i)}},f["default"].bindingHandlers.query={init:function(e,t,n,r,i){o.call(this,e,n,i)}},f["default"].bindingHandlers.path.utils={resolveHref:i}}])});